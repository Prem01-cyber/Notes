
***
###### `Title :- Analyzing Exploit PCAP's`
###### `Created on :- 2023-08-19 - 11:19`
###### `Created by:- Prem J`
***

We have gathered PCAP files from a recent Windows Active Directory Exploit called Zerologon or CVE-2020-1472

The scenario within the PCAP file contains a Windows Domain Controller with a private IP of 192.168.100.6 and an attacker with the private IP of 192.168.100.128. Let's walk through the steps of analyzing the PCAP and coming to a hypothesis of the events that happened.

![[Pasted image 20230819111950.png]]

#### `Attacker Identification -->`

- We can see unknown protocols in the pcap file in this case DCERPC and EPM
- Looking at the packets we see that 192.168.100.128 is sending all of the requests, so we can assume that the device is the attacker. 
- We can continue looking at packets coming from this IP to narrow down our hunt.
- Zerologon POC Connection Analysis

![[Pasted image 20230819112134.png]]

We can set a filter for the src of the IP that we believe to be suspicious.
When analyzing PCAPS we need to be aware of IOCs particular exploits may have with them

#### `Secretsdump SMB Analysis -->`

![[Pasted image 20230819113639.png]]

we can see SMB2/3 traffic and DRSUAPI traffic the attack uses secretsdump to dump hashes.
Secretsdump abuses SMB2/3 and DRSUAPI to do this, so we can assume that this traffic is secretsdump.

![[Pasted image 20230819113737.png]]

Each exploit and attack will come with its unique artifacts, in this case, it is clear what happened and the order of events that occurred. Once we have identified the attacker we would need to move on to other steps to identify and isolate as well as report the incident if we were on a Threat Hunting or DFIR team.