
***
###### `Title :- Creating Custom Wordlist`
###### `Created on :- 2023-06-28 - 06:50`
###### `Created by:- Prem J`
***

#### `Worlists -->`

- There might be some hashes that are more complex to breakdown with a normal wordlist, It may breakdown but takes a huge amount of time.
- It is necessary to create a custom, refined and targeted wordlist to achieve our goal in instances.

#### `Creating Wordlist -->`

- There are many tools that can be used in creating customised password wordlists

#### `1. Crunch -->`

- Crunch can create wordlists based on parameters such as words of a specific length, a limited character set, or a certain pattern. 
- It can generate both permutations and combinations.
- It is installed by default on Parrot OS and can be found [here](https://sourceforge.net/projects/crunch-wordlist/).

```shell-session
crunch <minimum length> <maximum length> <charset> -t <pattern> -o <output file>
```

- Above is crunch syntax for generating a wordlist, `-t` option is to specify the pattern for generated passwords.
- `@` - lowercase alphabets, `,` - Uppercase characters, `%` - Numbers and `^` - Symbols.

```shell-session
crunch 12 12 -t 10031998@@@@ -d 1 -o wordlist
crunch 17 17 -t ILFREIGHT201%@@@@ -o wordlist
```

- The "`-d`" option is used to specify the amount of repetition.

#### `2. CUPP -->`

- `CUPP` stands for `Common User Password Profiler`, and is used to create highly targeted and customized wordlists based on information gained from social engineering and OSINT.
- It was also used in [[Personalised Wordlists#`CUPP -->`]]
- These wordlists are mostly used to gain access to social media accounts. CUPP is installed by default on Parrot OS, and the repo can be found [here](https://github.com/Mebus/cupp). 
- The "`-i`" option is used to run in interactive mode, prompting `CUPP` to ask us for information on the target.

>[!Note]
>It also supports appending random characters and a "Leet" mode, which uses combinations of letters and numbers in common words. `CUPP` can also fetch common names from various online databases using the "`-l`" option.

#### `KWPROCESSOR -->`

- `Kwprocessor` is a tool that creates wordlists with keyboard walks,
- These passwords are called keyboard walks, as they look like a walk along the keys. For example, the string "`qwertyasdfg`" is created by using the first five characters from the keyboard's first two rows
- The tool can be found [here](https://github.com/hashcat/kwprocessor) and has to be installed manually.
- The pattern is based on the geographical directions a user could choose on the keyboard. For example, the "`--keywalk-west`" option is used to specify movement towards the west from the base character.
- Next, it needs a `keymap`, which maps the locations of keys on language-specific keyboard layouts.
- The final option is used to specify the route to be used. A route is a pattern to be followed by passwords. It defines how passwords will be formed, starting from the base characters.
- For example, the route `222` can denote the path `2 * EAST + 2 * SOUTH + 2 * WEST` from the base character
- If the base character is considered to be "`T`" then the password generated by the route would be "`TYUJNBV`" on a US keymap

```shell-session
kwp -s 1 basechars/full.base keymaps/en-us.keymap  routes/2-to-10-max-3-direction-changes.route
```

- The command above generates words with characters reachable while holding shift (`-s`), using the full base, the standard en-us keymap, and 3 direction changes route.

#### `3. Princeprocessor -->`

- `PRINCE` or `PRobability INfinite Chained Elements` is an efficient password guessing algorithm to improve password cracking rates.
- [Princeprocessor](https://github.com/hashcat/princeprocessor) is a tool that generates passwords using the PRINCE algorithm. The program takes in a wordlist and creates chains of words taken from this wordlist. 

```shell-session
# Wordlist
dog
cat
ball
```

```shell-session
# generated by Prince
dog
cat
ball
dogdog
catdog
dogcat
catcat
dogball
catball
balldog
ballcat
ballball
dogdogdog
catdogdog
dogcatdog
catcatdog
dogdogcat
<SNIP>
```

- The `PRINCE` algorithm considers various permutation and combinations while creating each word. The binary can be download from the [releases](https://github.com/hashcat/princeprocessor/releases) page.
- The "`--keyspace`" option can be used to find the number of combinations produced from the input wordlist.

```shell-session
./pp64.bin --keyspace < words  #Find the number of combos
./pp64.bin -o wordlist.txt < words  #Wordlist generation
```

>[!Note]
>The command above writes the output words to a file named `wordlist.txt`. By default, princeprocessor only outputs words up to 16 in length. This can be controlled using the "`--pw-min`" and "`--pw-max`" arguments.

```shell-session
./pp64.bin --pw-min=10 --pw-max=25 -o wordlist.txt < words
```

- The number of elements per word can be controlled using "`--elem-cnt-min`" and "`--elem-cnt-max`". These values ensure that number of elements in an output word is above or below the given value.

```shell-session
./pp64.bin --elem-cnt-min=3 -o wordlist.txt < words
```

- The command above will output words with three elements or more, i.e.," dogdogdog`.

#### `4. CeWL -->`

- [CeWL](https://github.com/digininja/CeWL) is another tool that can be used to create custom wordlists.
- it spiders across a webpage to create a list of words that are present.
- This kind of wordlist is effective, as people tend to use passwords associated with the content they write or operate on.

```shell-session
cewl -d <depth to spider> -m <minimum word length> -w <output wordlist> <url of website>
```

- CeWL can spider multiple pages present on a given website. The length of the outputted words can be altered using the "`-m`" parameter, depending on the password requirements (i.e., some websites have a minimum password length).
- CeWL also supports the extraction of emails from websites with the "`-e`" option. It's helpful to get this information when phishing, password spraying, or brute-forcing passwords later.

```shell-session
cewl -d 5 -m 8 -e http://inlanefreight.com/blog -w wordlist.txt
```

#### `5. Hashcat -->`

- By default, hashcat stores all cracked passwords in the `hashcat.potfile` file; the format is `hash:password`.
- The main purpose of this file is to remove previously cracked hashes from the work log and display cracked passwords with the `--show` command.
- However, it can be used to create new wordlists of previously cracked passwords, and when combined with rule files, it can prove quite effective at cracking themed passwords.

```shell-session 
cut -d: -f 2- ~/hashcat.potfile  #New wordlist creation
```

- The Hashcat-utils [repo](https://github.com/hashcat/hashcat-utils) contains many utilities that can be useful for more advanced password cracking. The tool [maskprocessor](https://github.com/hashcat/maskprocessor), for example, can be used to create wordlists using a given mask. 
- Detailed usage for this tool can be found [here](https://hashcat.net/wiki/doku.php?id=maskprocessor).
- For example, `maskprocessor` can be used to append all special characters to the end of a word:

```shell-session
premjampuram@htb[/htb]$ /mp64.bin Welcome?s
Welcome 
Welcome!
Welcome"
Welcome#
Welcome$
Welcome%
Welcome&
Welcome'
Welcome(
Welcome)

<SNIP>
```